# Hydrological Tool (Flask + Open-Meteo)

This repo contains a small Flask application that serves the frontend and performs Open-Meteo API calls and hydrological data processing on the backend.

Files added/changed:
- `app.py` — Flask application and `/api/analyze` endpoint. The server fetches Open-Meteo data year-by-year, processes it, and returns JSON results.
- `templates/index.html` — the frontend adapted to call the backend API instead of calling Open-Meteo directly.
- `requirements.txt` — Python dependencies.

Quick start (bash on Windows):

1. Create and activate a virtual environment:

```bash
python -m venv venv
source venv/Scripts/activate
```

2. Install dependencies:

```bash
pip install -r requirements.txt
```

3. Run the Flask app:

```bash
python app.py
```

4. Open http://127.0.0.1:5000 in your browser.

Notes:
- The frontend uses Chart.js and FileSaver via CDN.
- Data fetching and hydrological calculations are done in `app.py` (endpoint `/api/analyze`).
- CSV export remains client-side using the processed data returned from the server.
- Interactive location map:
	- This project now includes an interactive map (Leaflet + OpenStreetMap) embedded in the frontend.
	- Click the `Locate on Map` button to show the map and center it at the provided latitude and longitude.
	- You can drag the marker to update the lat/lon inputs, or edit lat/lon inputs to move the marker.
# Docker / Render deployment

Build and run locally with Docker:

```bash
# build image
docker build -t btp:latest .

# run locally
docker run -p 5000:5000 btp:latest
```

Typical Render steps (Docker):

1. Push this repo to GitHub (or connect your repository to Render).
2. In Render dashboard, create a new Web Service.
	- Environment: `Docker`
	- Branch: `main`
	- Dockerfile path: `./Dockerfile`
3. Set any environment variables on Render (if needed).
4. Deploy — Render will build the Docker image and serve your app on a public URL.

Alternatively, you can include `render.yaml` (this repo already has one) and use it to define the service in code.


$ python app.py 
# btp
